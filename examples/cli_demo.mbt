// CLIå·¥å…·ä¸­çš„çœŸå®ä½¿ç”¨æ¡ˆä¾‹æ¼”ç¤º
// éªŒè¯MoonProgressåœ¨å®é™…å‘½ä»¤è¡Œå·¥å…·ä¸­çš„åº”ç”¨

///| æ¨¡æ‹Ÿæ–‡ä»¶ä¸‹è½½CLIå·¥å…·
fn demo_file_download() -> Unit {
  println("ğŸ“¥ æ–‡ä»¶ä¸‹è½½å·¥å…·æ¼”ç¤º")
  println("ä¸‹è½½æ–‡ä»¶: large_dataset.zip (1000MB)")
  let pb = @MoonProgress/src.new(1000)
    .set_desc("ä¸‹è½½")
    .set_unit("MB")
    .set_show_percent(true)
    .set_show_rate(true)
    .set_show_count(true)
  let mut downloaded = 0
  let download_speeds = [45, 52, 48, 61, 55, 49, 58, 63, 57, 44]
  for speed in download_speeds {
    // æ¨¡æ‹Ÿä¸‹è½½ä¸€ä¸ªæ•°æ®å—ï¼ˆå®é™…ä¸šåŠ¡é€»è¾‘åœ¨è¿™é‡Œï¼‰
    downloaded = downloaded + speed

    // è¿›åº¦æ¡åªè´Ÿè´£æ˜¾ç¤ºå½“å‰çŠ¶æ€
    println(pb.update(downloaded).render())
  }
  println("âœ… ä¸‹è½½å®Œæˆï¼")
}

///| æ¨¡æ‹Ÿæ•°æ®å¤„ç†CLIå·¥å…·  
fn demo_data_processing() -> Unit {
  println("\nğŸ”„ æ•°æ®å¤„ç†å·¥å…·æ¼”ç¤º")
  println("å¤„ç†ç”¨æˆ·æ•°æ®: 50000æ¡è®°å½•")
  let pb = @MoonProgress/src.new(50000)
    .set_desc("å¤„ç†ç”¨æˆ·æ•°æ®")
    .set_unit("records")
    .set_show_percent(true)
    .set_show_eta(true)
    .set_show_count(true)
  let batch_sizes = [5000, 8000, 12000, 10000, 7000, 8000]
  let mut processed = 0
  for batch_size in batch_sizes {
    // æ¨¡æ‹Ÿå¤„ç†ä¸€æ‰¹æ•°æ®ï¼ˆå®é™…ä¸šåŠ¡é€»è¾‘åœ¨è¿™é‡Œï¼‰
    processed = processed + batch_size

    // è¿›åº¦æ¡æ˜¾ç¤ºå¤„ç†è¿›åº¦
    println(pb.update(processed).render())
  }
  println("âœ… æ•°æ®å¤„ç†å®Œæˆï¼")
}

///| æ¨¡æ‹Ÿæµ‹è¯•è¿è¡Œå™¨CLIå·¥å…·
fn demo_test_runner() -> Unit {
  println("\nğŸ§ª æµ‹è¯•è¿è¡Œå™¨æ¼”ç¤º")
  println("è¿è¡Œæµ‹è¯•å¥—ä»¶: 150ä¸ªæµ‹è¯•ç”¨ä¾‹")
  let pb = @MoonProgress/src.new(150)
    .set_desc("è¿è¡Œæµ‹è¯•")
    .set_prefix("è¿›åº¦")
    .set_show_percent(true)
    .set_show_count(true)
    .set_width(30)
  let test_batches = [15, 23, 18, 27, 22, 19, 26]
  let mut completed = 0
  for batch in test_batches {
    // æ¨¡æ‹Ÿè¿è¡Œä¸€æ‰¹æµ‹è¯•ï¼ˆå®é™…æµ‹è¯•é€»è¾‘åœ¨è¿™é‡Œï¼‰
    completed = completed + batch

    // è¿›åº¦æ¡æ˜¾ç¤ºæµ‹è¯•è¿›åº¦
    println(pb.update(completed).render())
  }
  println("âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼")
}

///| æ¨¡æ‹Ÿæ„å»ºå·¥å…·CLI
fn demo_build_tool() -> Unit {
  println("\nğŸ”¨ æ„å»ºå·¥å…·æ¼”ç¤º")
  println("ç¼–è¯‘é¡¹ç›®: 200ä¸ªæºæ–‡ä»¶")
  let pb = @MoonProgress/src.new(200)
    .set_desc("ç¼–è¯‘")
    .set_suffix("files")
    .set_show_percent(true)
    .set_show_count(true)
    .set_fill('â– ')
    .set_empty('â–¡')
  let compile_batches = [25, 35, 40, 30, 28, 22, 20]
  let mut compiled = 0
  for batch in compile_batches {
    // æ¨¡æ‹Ÿç¼–è¯‘ä¸€æ‰¹æ–‡ä»¶ï¼ˆå®é™…ç¼–è¯‘é€»è¾‘åœ¨è¿™é‡Œï¼‰
    compiled = compiled + batch

    // è¿›åº¦æ¡æ˜¾ç¤ºç¼–è¯‘è¿›åº¦
    println(pb.update(compiled).render())
  }
  println("âœ… æ„å»ºæˆåŠŸï¼")
}

///| æ¼”ç¤ºçœŸå®ä¸–ç•Œçš„ä½¿ç”¨åœºæ™¯
fn demo_real_world_usage() -> Unit {
  println("\nğŸ’¼ çœŸå®CLIå·¥å…·é›†æˆæ¼”ç¤º")

  // åœºæ™¯1ï¼šå¼€ç®±å³ç”¨ - 3è¡Œä»£ç 
  println("1. æœ€ç®€ä½¿ç”¨ï¼ˆ3è¡Œä»£ç ï¼‰:")
  let simple_pb = @MoonProgress/src.new(100).update(65)
  println("   " + simple_pb.render())

  // åœºæ™¯2ï¼šé…ç½®ä¸°å¯Œä½†ä»ç„¶ç®€å•
  println("\n2. ä¸°å¯Œé…ç½®ä½†ä»ç®€å•:")
  let rich_pb = @MoonProgress/src.new(200)
    .set_desc("å¤„ç†")
    .set_show_percent(true)
    .set_show_count(true)
    .set_show_rate(true)
    .update(150)
  println("   " + rich_pb.render())

  // åœºæ™¯3ï¼šæ¼”ç¤ºæ—¶é—´æ— å…³æ€§
  println("\n3. è¯æ˜æ—¶é—´æ— å…³æ€§ï¼ˆè¿ç»­æ›´æ–°ï¼‰:")
  let mut pb = @MoonProgress/src.new(10)
    .set_desc("å¿«é€Ÿæ›´æ–°")
    .set_show_percent(true)
  for i = 0; i <= 10; i = i + 1 {
    pb = pb.update(i)
    println("   " + pb.render())
  }
}

///| ä¸»å‡½æ•°ï¼šå±•ç¤ºæ‰€æœ‰CLIå·¥å…·ç”¨ä¾‹
fn main {
  println("ğŸŒ™ MoonProgress - CLIå·¥å…·çœŸå®ä½¿ç”¨æ¡ˆä¾‹")
  println("==================================================")
  demo_file_download()
  demo_data_processing()
  demo_test_runner()
  demo_build_tool()
  demo_real_world_usage()
  println("\nğŸ‰ æ‰€æœ‰æ¼”ç¤ºå®Œæˆï¼")
  println(
    "ğŸ’¡ å¦‚ä½ æ‰€è§ï¼ŒMoonProgresså®Œç¾é€‚ç”¨äºå„ç§CLIå·¥å…·çš„è¿›åº¦æ˜¾ç¤ºéœ€æ±‚",
  )
  println(
    "ğŸ”¥ è™šæ‹Ÿæ—¶é—´è®¾è®¡è®©å®ƒæ¯”tqdmæ›´å¿«ã€æ›´ç®€å•ã€æ›´å¯é ï¼",
  )
}
